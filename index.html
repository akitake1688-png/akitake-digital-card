<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§‹æ­¦é€»è¾‘ Â· å‡å­¦é˜²å¾¡ç³»ç»Ÿ</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.9); 
            --accent-color: #334155; 
            --brand-blue: #3b82f6;   
            --text-main: #1e293b;                   
            --bot-bubble: #ffffff;
            --user-bubble: #eff6ff;
            --bg-gradient: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: "Helvetica Neue", "PingFang SC", sans-serif; }

        body {
            background: var(--bg-gradient);
            height: 100vh; display: flex; justify-content: center; align-items: center;
            color: var(--text-main); overflow: hidden;
        }

        .glass-container {
            width: 95vw; height: 92vh; max-width: 1100px;
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 24px;
            display: flex; box-shadow: 0 40px 100px -20px rgba(0, 0, 0, 0.12); overflow: hidden;
        }

        /* ä¾§è¾¹æ  */
        .side-panel { width: 300px; border-right: 1px solid rgba(0,0,0,0.06); background: rgba(255,255,255,0.4); padding: 40px 20px; display: flex; flex-direction: column; }
        .avatar-ring {
            width: 85px; height: 85px; border-radius: 50%; padding: 4px;
            background: linear-gradient(135deg, var(--brand-blue), var(--accent-color)); margin: 0 auto 20px;
        }
        .avatar-main { width: 100%; height: 100%; border-radius: 50%; border: 3px solid white; background: var(--accent-color); display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 26px; }
        .profile-card h2 { font-size: 1.3rem; text-align: center; color: var(--accent-color); margin-bottom: 8px; letter-spacing: 0.1em; }
        .bio { font-size: 0.82rem; color: #64748b; text-align: center; margin-bottom: 25px; line-height: 1.6; }

        .nav-container { flex: 1; overflow-y: auto; padding-right: 5px; }
        .nav-btn {
            width: 100%; padding: 12px 15px; border-radius: 12px; border: none; background: transparent;
            color: var(--text-main); text-align: left; cursor: pointer; transition: 0.2s ease;
            margin-bottom: 8px; font-size: 0.88rem; font-weight: 500; letter-spacing: 0.05em;
        }
        .nav-btn:hover { background: rgba(59, 130, 246, 0.08); color: var(--brand-blue); transform: translateX(5px); }

        /* èŠå¤©åŒºåŸŸ */
        .chat-viewport { flex: 1; display: flex; flex-direction: column; background: rgba(255, 255, 255, 0.2); }
        .messages-area { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        
        .msg-row { display: flex; width: 100%; }
        .msg-row.bot { justify-content: flex-start; }
        .msg-row.user { justify-content: flex-end; }

        .bubble { 
            max-width: 85%; padding: 15px 22px; border-radius: 20px; line-height: 1.8; 
            font-size: 0.98rem; box-shadow: 0 4px 15px rgba(0,0,0,0.03); word-break: break-word; 
        }
        .bot .bubble { background: var(--bot-bubble); border: 1px solid #f1f5f9; border-bottom-left-radius: 4px; }
        .user .bubble { background: var(--user-bubble); border: 1px solid #dbeafe; border-bottom-right-radius: 4px; }

        .input-bar { padding: 25px; background: white; border-top: 1px solid #f1f5f9; display: flex; gap: 15px; }
        #user-input { flex: 1; padding: 14px 25px; border-radius: 30px; border: 1px solid #e2e8f0; outline: none; font-size: 1rem; }
        #send-btn { padding: 0 28px; border-radius: 30px; background: var(--accent-color); color: white; cursor: pointer; border: none; font-weight: 600; }

        @media (max-width: 768px) { .side-panel { display: none; } }
    </style>
</head>
<body>

<div class="glass-container">
    <div class="side-panel">
        <div class="avatar-ring"><div class="avatar-main">ç§‹</div></div>
        <div class="profile-card">
            <h2>ç§‹æ­¦é€»è¾‘</h2>
            <p class="bio">ä¸œå¤§æ–‡ç†äº¤å‰èƒŒæ™¯<br>ç”Ÿæ€/ç”Ÿç‰©/ç¯å¢ƒæœ¬é˜µå®ˆæŠ¤<br>å‡å­¦é˜²å¾¡ä½“ç³»æ¶æ„å¸ˆ</p>
        </div>
        <div class="nav-container" id="nav-btns"></div>
    </div>
    <div class="chat-viewport">
        <div class="messages-area" id="chat-container">
            <div class="msg-row bot"><div class="bubble">æ¬¢è¿è®¿é—®<b>ã€ç§‹æ­¦é€»è¾‘ Â· å‡å­¦é˜²å¾¡ç³»ç»Ÿã€</b>ã€‚<br>ç”±äºæ ¸å¿ƒé€»è¾‘å·²åµŒå…¥æ­¤é¡µé¢ï¼Œç³»ç»Ÿç°å·²æ”¯æŒç¦»çº¿é˜²å¾¡ã€‚</div></div>
        </div>
        <div class="input-bar">
            <input type="text" id="user-input" placeholder="è¾“å…¥å…³é”®è¯..." onkeypress="if(event.keyCode==13) handleSearch()">
            <button id="send-btn" onclick="handleSearch()">å‘é€</button>
        </div>
    </div>
</div>

<script>
    // ç‰©ç†åµŒå…¥çš„ Knowledge Data (å…¨é‡è¡¥å…¨ç‰ˆ)
    const KNOWLEDGE_DATA = [
        { "intent": "ä¿®å£«", "nav_btn": "ä¿®å£«/ç ”ç©¶ç”Ÿ/å†…è¯º", "keywords": ["ä¿®å£«", "ç ”ç©¶ç”Ÿ", "å¤§å­¦é™¢", "å†…è¯º"], "response": "<b>ã€å¤§å­¦é™¢ï¼šæ–‡ç†äº¤å‰çš„å®šåˆ¶åŒ–ç ´å±€ã€‘</b><br><br>ä¾§é‡äº<b>â€œä¸€é—®ä¸€ç­”å¼é¢è¯•è‰ç¨¿â€</b>çš„æ·±åº¦å®šåˆ¶ã€‚ç§‹æ­¦è€å¸ˆäº²è‡ªå‚ä¸æ¯ä¸€å¥é€»è¾‘æ‰“ç£¨ï¼Œç¡®ä¿ä½ åœ¨æ•™æˆé¢å‰ä¸ä»…åˆæ ¼ï¼Œä¸”ä¸å¯æ›¿ä»£ã€‚" },
        { "intent": "æœ¬é˜µ", "nav_btn": "ç”Ÿæ€/ç”Ÿç‰©/æœ¬é˜µ", "keywords": ["ç”Ÿæ€", "ç”Ÿç‰©", "ç†ç§‘", "äº¤å‰"], "response": "<b>ã€æœ¬é˜µä¸“é¡¹ï¼šç”Ÿæ€ä¸ç†ç§‘çš„æ·±åº¦æ¸—é€ã€‘</b><br><br>è¿™æ˜¯ç§‹æ­¦è€å¸ˆçš„ä¸“ä¸šé˜µåœ°ã€‚æˆ‘ä»¬åœ¨è¯¾é¢˜é€»è¾‘ã€å®éªŒè®¾è®¡ä¸Šæä¾›ç²¾å‡†ä¿®æ­£ã€‚<br>å…¬å¼æ¼”ç¤ºï¼š$$R-COOH + R'-OH \\xrightarrow[H_2SO_4]{\\Delta} R-COOR' + H_2O$$" },
        { "intent": "RP", "nav_btn": "RP/é¢è¯•/è¡¥ç¼", "keywords": ["ç ”ç©¶è®¡åˆ’ä¹¦", "RP", "é¢è¯•", "å¿—æœ›"], "response": "<b>ã€æ–‡ä¹¦ä¸é¢è¯•ï¼šé˜²å¾¡ä½“ç³»çš„æ•´ä½“å»ºæ„ã€‘</b><br><br>å»ºç«‹ $H_0/H_1$ çš„å‡è®¾é—­ç¯ã€‚æ–‡ä¹¦æ˜¯é¢è¯•çš„é¢„æ¼”ï¼Œé¢è¯•æ˜¯æ–‡ä¹¦çš„è¾©æŠ¤ã€‚" },
        { "intent": "EJU", "nav_btn": "EJU/å°è®ºæ–‡å†™ä½œ", "keywords": ["EJU", "ç•™è€ƒ", "å°è®ºæ–‡", "è®°è¿°"], "response": "<b>ã€å­¦éƒ¨ï¼šé€»è¾‘é‡‡æ ·è€Œéæ–‡åŒ–è¯¾åŸ¹è®­ã€‘</b><br><br>ä¸“æ³¨äº<b>æ—¥æ–‡å°è®ºæ–‡ä¸è®°è¿°é¢˜çš„å†™ä½œé€»è¾‘</b>ã€‚ä¸æ•™æˆæ•°ç†åŒ–ç”ŸåŸºç¡€è¯¾ã€‚" },
        { "intent": "ç¼–å…¥", "nav_btn": "å¤§å­¦ç¼–å…¥/æ’ç­", "keywords": ["ç¼–å…¥", "æ’ç­", "ä¾¿å…¥"], "response": "<b>ã€ç¼–å…¥å­¦ï¼šè·¨å­¦ç§‘è½¬æ¢çš„ç²¾å¯†å¥‘åˆã€‘</b><br><br>é¢è¯•å®˜å…³æ³¨â€œå³æˆ˜åŠ›â€ã€‚é’ˆå¯¹å¿—æœ›ç†ç”±ä¹¦ä¸é¢è¯•ç­”è¾©è¿›è¡Œ<b>é€»è¾‘è¡¥ç¼</b>ã€‚" },
        { "intent": "å¼‚æ–‡åŒ–", "nav_btn": "è¯»ç©ºæ°”/ç”Ÿå­˜ç­–ç•¥", "keywords": ["è¯»ç©ºæ°”", "ç”Ÿå­˜", "å¼‚æ–‡åŒ–"], "response": "<b>ã€å¼‚æ–‡åŒ–ï¼šæ—¥æœ¬ç¤¾ä¼šçš„ç”Ÿå­˜é€»è¾‘ã€‘</b><br><br>ç†è§£â€œè¯»ç©ºæ°”â€çš„éšå½¢è§„åˆ™ã€‚ç•™å­¦ä¸åªæ˜¯å‡å­¦ï¼Œæ›´æ˜¯ç”Ÿæ€ä½çš„é‡å¡‘ã€‚" },
        { "intent": "è‰ºæœ¯", "nav_btn": "ç¾æœ¯/è‰ºæœ¯/ä½œå“é›†", "keywords": ["è‰ºæœ¯", "ç¾æœ¯", "ç”»å®¤"], "response": "<b>ã€è‰ºæœ¯ç±»ï¼šè¾…å¯¼é€»è¾‘ï¼Œä¸è¾…å¯¼ç”»ç¬”ã€‘</b><br><br>è´Ÿè´£<b>â€œè‰ºæœ¯é€»è¾‘çš„å¯è§†åŒ–è¾©æŠ¤â€</b>ã€‚å¦‚ä½•ç”¨å­¦æœ¯é€»è¾‘å‘æ•™æˆé˜è¿°ä½ çš„åˆ›ä½œåŠ¨æœºã€‚" },
        { "intent": "è”ç³»", "nav_btn": "è”ç³»ç§‹æ­¦/å¾®ä¿¡å·", "keywords": ["å¾®ä¿¡", "è”ç³»", "è´¹ç”¨"], "response": "<b>ã€ç§‹æ­¦é€»è¾‘ï¼šçœŸå®ã€é«˜æ•ˆã€ä¸€é’ˆè§è¡€ã€‘</b><br><b>è”ç³»å¾®ä¿¡ï¼šqiuwu999</b><br><br>ç§‹æ­¦è€å¸ˆé™ªä½ åƒé€æœ€éš¾çš„é€»è¾‘ï¼ğŸ˜Š" }
    ];

    let isTyping = false;
    const navBox = document.getElementById('nav-btns');
    
    // åˆå§‹åŒ–æ¸²æŸ“æŒ‰é’®
    KNOWLEDGE_DATA.forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'nav-btn';
        btn.innerText = item.nav_btn;
        btn.onclick = () => { if(!isTyping) typeEffect(item.response); };
        navBox.appendChild(btn);
    });

    async function handleSearch() {
        const input = document.getElementById('user-input');
        const query = input.value.trim().toLowerCase();
        if (!query || isTyping) return;
        addMessage(input.value, 'user');
        input.value = "";
        const match = KNOWLEDGE_DATA.find(item => item.keywords.some(k => query.includes(k)));
        if (match) { await typeEffect(match.response); } 
        else { await typeEffect("é€»è¾‘åº“æœªåŒ¹é…ã€‚å»ºè®®ç›´æ¥å’¨è¯¢ï¼š<b>qiuwu999</b>"); }
    }

    function addMessage(text, role) {
        const chat = document.getElementById('chat-container');
        const row = document.createElement('div');
        row.className = `msg-row ${role}`;
        row.innerHTML = `<div class="bubble">${text}</div>`;
        chat.appendChild(row);
        chat.scrollTop = chat.scrollHeight;
    }

    function typeEffect(text) {
        return new Promise(resolve => {
            isTyping = true;
            const chat = document.getElementById('chat-container');
            const row = document.createElement('div');
            row.className = 'msg-row bot';
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            row.appendChild(bubble);
            chat.appendChild(row);

            let i = 0;
            const interval = setInterval(() => {
                if (i < text.length) {
                    if (text[i] === '<') {
                        let end = text.indexOf('>', i);
                        bubble.innerHTML += text.substring(i, end + 1);
                        i = end + 1;
                    } else {
                        bubble.innerHTML += text[i];
                        i++;
                    }
                    chat.scrollTop = chat.scrollHeight;
                } else {
                    clearInterval(interval);
                    isTyping = false;
                    // å®‰å…¨æ¸²æŸ“å…¬å¼
                    if (window.MathJax && MathJax.typesetPromise) {
                        MathJax.typesetPromise([bubble]).catch(e => console.log(e));
                    }
                    resolve();
                }
            }, 12);
        });
    }
</script>
</body>
</html>
