<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§‹æ­¦é€»è¾‘ Â· å‡å­¦é˜²å¾¡ç³»ç»Ÿ</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.85); 
            --accent-color: #3b82f6; /* ç†ç§‘è“ */
            --text-main: #1f2937;
            --bot-bubble: #ffffff;
            --user-bubble: #3b82f6;
            --bg-gradient: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: "PingFang SC", "Microsoft YaHei", sans-serif; }

        body {
            background: var(--bg-gradient);
            height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden;
        }

        .glass-container {
            width: 95vw; height: 92vh; max-width: 1100px;
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 24px;
            display: flex; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); overflow: hidden;
        }

        /* ä¾§è¾¹æ  */
        .side-panel { width: 280px; border-right: 1px solid rgba(0,0,0,0.06); display: flex; flex-direction: column; padding: 24px; background: rgba(255,255,255,0.3); }
        .avatar-ring {
            width: 75px; height: 75px; border-radius: 50%; padding: 3px;
            background: linear-gradient(45deg, var(--accent-color), #60a5fa); margin: 0 auto 15px;
        }
        .avatar-main { width: 100%; height: 100%; border-radius: 50%; border: 2px solid white; object-fit: cover; }
        .profile-card h2 { font-size: 1.2rem; text-align: center; margin-bottom: 5px; color: var(--text-main); letter-spacing: 1px; }
        .bio { font-size: 0.8rem; color: #64748b; text-align: center; line-height: 1.6; margin-bottom: 20px; }

        .nav-section { flex: 1; overflow-y: auto; padding-right: 4px; }
        .nav-btn {
            width: 100%; padding: 12px 16px; border-radius: 12px; border: none; background: transparent;
            color: var(--text-main); text-align: left; cursor: pointer; transition: 0.25s;
            margin-bottom: 6px; font-size: 0.9rem; display: flex; align-items: center; letter-spacing: 0.05em;
        }
        .nav-btn:hover { background: rgba(59, 130, 246, 0.08); transform: translateX(4px); }
        .nav-btn.active { background: var(--accent-color); color: white; }

        /* èŠå¤©åŒº */
        .chat-viewport { flex: 1; display: flex; flex-direction: column; background: rgba(255, 255, 255, 0.2); }
        .messages-area { flex: 1; padding: 25px; overflow-y: auto; display: flex; flex-direction: column; gap: 18px; }
        
        .msg-row { display: flex; width: 100%; margin-bottom: 4px; }
        .msg-row.user { justify-content: flex-end; }
        .avatar-chat { width: 38px; height: 38px; border-radius: 50%; margin-right: 12px; flex-shrink: 0; }
        .avatar-placeholder { width: 38px; margin-right: 12px; flex-shrink: 0; }

        .bubble { 
            max-width: 80%; padding: 14px 18px; border-radius: 18px; line-height: 1.7; 
            font-size: 0.96rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); word-break: break-word; 
        }
        .bot .bubble { background: var(--bot-bubble); color: var(--text-main); border-top-left-radius: 4px; border: 1px solid #f1f5f9; }
        .user .bubble { background: var(--user-bubble); color: white; border-top-right-radius: 4px; }

        .input-bar { padding: 20px 25px; display: flex; gap: 12px; background: rgba(255,255,255,0.4); }
        #user-input { flex: 1; padding: 14px 22px; border-radius: 14px; border: 1px solid rgba(0,0,0,0.1); outline: none; }
        #send-btn { padding: 0 24px; border-radius: 14px; background: var(--accent-color); color: white; cursor: pointer; border: none; font-weight: 500; }

        @media (max-width: 768px) { .side-panel { display: none; } }
    </style>
</head>
<body>

<div class="glass-container">
    <div class="side-panel">
        <div class="avatar-ring">
            <img src="profile.jpg" class="avatar-main" onerror="this.src='https://via.placeholder.com/100?text=ç§‹'">
        </div>
        <div class="profile-card">
            <h2>ç§‹æ­¦é€»è¾‘</h2>
            <p class="bio">ä¸œå¤§æ–‡ç†äº¤å‰èƒŒæ™¯<br>ç”Ÿæ€/ç”Ÿç‰©/ç¯å¢ƒæœ¬é˜µå®ˆæŠ¤<br>â€œä¸€é’ˆè§è¡€çš„é€»è¾‘è¡¥ç¼â€</p>
        </div>
        <div class="nav-section" id="nav-btns-container"></div>
    </div>

    <div class="chat-viewport">
        <div class="messages-area" id="chat-container"></div>
        <div class="input-bar">
            <input type="text" id="user-input" placeholder="è¾“å…¥å…³é”®è¯å’¨è¯¢..." onkeypress="if(event.keyCode==13) handleSearch()">
            <button id="send-btn" onclick="handleSearch()">å‘é€</button>
        </div>
    </div>
</div>

<script>
    // â¶ è¡¥å…¨åçš„å…¨é‡é«˜çº§ JSON æ•°æ® (å†…ç½® BREAK é€»è¾‘)
    const KNOWLEDGE_DATA = [
        {
            "intent": "01_ä¿®å£«ç ”ç©¶ç”Ÿ",
            "nav_btn": "ä¿®å£«/ç ”ç©¶ç”Ÿ/å†…è¯º",
            "keywords": ["ä¿®å£«", "ç¡•å£«", "ç ”ç©¶ç”Ÿ", "é¢„ç§‘", "å¤§å­¦é™¢", "å†…è¯º", "å¥—ç£"],
            "response": "<b>ã€å¤§å­¦é™¢ï¼šæ–‡ç†äº¤å‰çš„å®šåˆ¶åŒ–ç ´å±€ã€‘</b> [BREAK] <b>é—®ï¼šä¿®å£«ç”³è¯·æœ€æ ¸å¿ƒçš„äº¤ä»˜æ˜¯ä»€ä¹ˆï¼Ÿ</b> [BREAK] ç­”ï¼šæ˜¯<b>â€œä¸€é—®ä¸€ç­”å¼é¢è¯•ç­”è¾©è‰ç¨¿â€çš„æ·±åº¦å®šåˆ¶</b>ã€‚ [BREAK] ç§‹æ­¦è€å¸ˆä¼šæ ¹æ®ä½ çš„èƒŒæ™¯ï¼Œäº²è‡ªæ‰“ç£¨æ¯ä¸€å¥é€»è¾‘è¡¥ç¼ã€‚"
        },
        {
            "intent": "02_æœ¬é˜µä¸“é¡¹",
            "nav_btn": "ç†ç§‘/ç”Ÿæ€/ç”Ÿç‰©",
            "keywords": ["ç”Ÿæ€", "ç”Ÿç‰©", "ç†ç§‘", "äº¤å‰", "æœ¬é˜µ"],
            "response": "<b>ã€ç†ç§‘ä¸ç”Ÿæ€ï¼šæœ¬é˜µçº§æ·±åº¦æ¸—é€ã€‘</b> [BREAK] è¿™æ­£æ˜¯ç§‹æ­¦è€å¸ˆçš„â€œæœ¬é˜µâ€æ‰€åœ¨ï¼ˆä¸œå¤§æ–‡ç†èåˆèƒŒæ™¯ï¼‰ã€‚ [BREAK] æˆ‘ä»¬åœ¨<b>ç ”ç©¶è¯¾é¢˜é€»è¾‘ã€å®éªŒè®¾è®¡é™ˆè¿°</b>ä¸Šæä¾›ç²¾å‡†ä¿®æ­£ã€‚ [BREAK] $$R-COOH + R'-OH \\xrightarrow[H_2SO_4]{\\Delta} R-COOR' + H_2O$$"
        },
        {
            "intent": "03_æ–‡ä¹¦é¢è¯•",
            "nav_btn": "RP/é¢è¯•/è¡¥ç¼",
            "keywords": ["ç ”ç©¶è®¡åˆ’ä¹¦", "RP", "å¿—æœ›ç†ç”±ä¹¦", "é¢è¯•", "ç­”è¾©"],
            "response": "<b>ã€æ–‡ä¹¦ä¸é¢è¯•ï¼šé˜²å¾¡ä½“ç³»çš„æ•´ä½“å»ºæ„ã€‘</b> [BREAK] è¾…å¯¼é‡ç‚¹åœ¨äºå»ºç«‹ $H_0/H_1$ çš„å‡è®¾é—­ç¯ã€‚ [BREAK] æ‰€æœ‰çš„æ–‡ä¹¦ä¿®æ”¹éƒ½æ˜¯ä¸ºäº†ç»™é¢è¯•åŸ‹ä¸‹é€»è¾‘ä¼ç¬”ã€‚"
        },
        {
            "intent": "04_EJUå°è®ºæ–‡",
            "nav_btn": "EJU/å°è®ºæ–‡å†™ä½œ",
            "keywords": ["EJU", "ç•™è€ƒ", "è®°è¿°", "å°è®ºæ–‡"],
            "response": "<b>ã€å­¦éƒ¨ï¼šé€»è¾‘é‡‡æ ·è€Œéæ–‡åŒ–è¯¾åŸ¹è®­ã€‘</b> [BREAK] æˆ‘ä»¬ä¸“æ³¨äº<b>â€œæ—¥æ–‡å°è®ºæ–‡ä¸è®°è¿°é¢˜çš„å†™ä½œé€»è¾‘â€</b>ã€‚ [BREAK] ç”±äºè¾…å¯¼æåº¦ä¾èµ–ç°æœ‰æ°´å¹³ï¼Œå»ºè®®ä¸ç§‹æ­¦è€å¸ˆæœ¬äººç»†è°ˆã€‚"
        },
        {
            "intent": "05_ç¼–å…¥å­¦",
            "nav_btn": "å¤§å­¦ç¼–å…¥/æ’ç­",
            "keywords": ["ç¼–å…¥", "æ’ç­", "ä¾¿å…¥å­¦"],
            "response": "<b>ã€ç¼–å…¥å­¦ï¼šä¸“ä¸šè½¬æ¢çš„é€»è¾‘æ¡¥æ¢ã€‘</b> [BREAK] ç¼–å…¥é¢è¯•å®˜æœ€å…³æ³¨â€œå³æˆ˜åŠ›â€ã€‚ [BREAK] ç§‹æ­¦è€å¸ˆé’ˆå¯¹ç¼–å…¥è€ƒè¯•ä¸­å…³é”®çš„å¿—æœ›ç†ç”±ä¹¦è¿›è¡Œé€»è¾‘è¡¥æ¼ã€‚"
        },
        {
            "intent": "06_å¼‚æ–‡åŒ–",
            "nav_btn": "è¯»ç©ºæ°”/ç”Ÿå­˜ç­–ç•¥",
            "keywords": ["è¯»ç©ºæ°”", "å¼‚æ–‡åŒ–", "ç”Ÿå­˜ç­–ç•¥", "ç¤¾ä¼š"],
            "response": "<b>ã€å¼‚æ–‡åŒ–ï¼šç•™å­¦çš„åº•å±‚ç”Ÿå­˜é€»è¾‘ã€‘</b> [BREAK] ç†è§£æ—¥æœ¬æ•™è‚²ä½“åˆ¶ä¸­â€œè¯»ç©ºæ°”â€çš„éšå½¢è§„åˆ™ã€‚ [BREAK] å»ºç«‹å¥åº·çš„ç”Ÿæ€ä½ï¼Œä¼šè®©ä½ çš„é¢è¯•æ˜¾å¾—æ›´æœ‰å¿ƒç†æˆç†Ÿåº¦ã€‚"
        },
        {
            "intent": "07_è‰ºæœ¯ç¾æœ¯",
            "nav_btn": "ç¾æœ¯/è‰ºæœ¯/ä½œå“é›†",
            "keywords": ["ç¾æœ¯", "è‰ºæœ¯", "ä½œå“é›†", "ç”»å®¤"],
            "response": "<b>ã€è‰ºæœ¯ç±»ï¼šè¾…å¯¼é€»è¾‘ï¼Œä¸è¾…å¯¼ç”»ç¬”ã€‘</b> [BREAK] ç§‹æ­¦è€å¸ˆä¸è¾…å¯¼ä»»ä½•å®æŠ€ï¼Œåªè´Ÿè´£<b>â€œè‰ºæœ¯é€»è¾‘çš„å¯è§†åŒ–è¾©æŠ¤â€</b>ã€‚ [BREAK] å¸®ä½ ç”¨å­¦æœ¯é€»è¾‘å‘æ•™æˆé˜è¿°åˆ›ä½œåŠ¨æœºã€‚"
        },
        {
            "intent": "08_ç§å¡¾å…±ç”Ÿ",
            "nav_btn": "ç§å¡¾/å·²ç»åœ¨å¡¾",
            "keywords": ["ç§å¡¾", "æœºæ„", "å·²ç»åœ¨å¡¾"],
            "response": "<b>ã€é«˜é˜¶æ’ä»¶ï¼šä¸ºç§å¡¾å­¦ä¹ è€…è¡¥è¶³æœ€å 1%ã€‘</b> [BREAK] äº‹å®ï¼šç§‹æ­¦è€å¸ˆç»å¤§éƒ¨åˆ†å­¦ç”Ÿéƒ½æ¥è‡ªç§å¡¾ã€‚ [BREAK] ç§å¡¾è§£å†³é€šè¯†ï¼Œç§‹æ­¦è€å¸ˆè§£å†³<b>â€œåŸºäºä¸ªäººåŸºç¡€çš„å®šåˆ¶åŒ–ç­”è¾©è‰ç¨¿â€</b>ã€‚"
        },
        {
            "intent": "10_å“ç‰Œè”ç³»",
            "nav_btn": "è”ç³»ç§‹æ­¦/å¾®ä¿¡å·",
            "keywords": ["å¾®ä¿¡", "è”ç³»", "è´¹ç”¨", "ç§‹æ­¦"],
            "response": "<b>ã€ç§‹æ­¦é€»è¾‘ï¼šä¸€é’ˆè§è¡€çš„çœŸå®ç£å¯¼ã€‘</b> [BREAK] ğŸ’¬ å¾®ä¿¡å·ï¼š<b>qiuwu999</b> [BREAK] ç§‹æ­¦è€å¸ˆè™½ç„¶ä¸å¥½åƒï¼Œä½†ä¼šé™ªä½ åƒé€æœ€éš¾çš„é€»è¾‘ï¼ğŸ˜Š"
        }
    ];

    let isTyping = false;
    const wait = (ms) => new Promise(res => setTimeout(res, ms));

    // æ¸²æŸ“ä¾§è¾¹æ 
    function initNav() {
        const container = document.getElementById('nav-btns-container');
        KNOWLEDGE_DATA.forEach(item => {
            const btn = document.createElement('button');
            btn.className = 'nav-btn';
            btn.innerHTML = `<span>âš¡</span>&nbsp;${item.nav_btn}`;
            btn.onclick = () => { if(!isTyping) handleInquiry(item); };
            container.appendChild(btn);
        });
    }

    // å¤„ç†äº¤äº’é€»è¾‘ (åŒ…å« BREAK åˆ†æ®µ)
    async function handleInquiry(item) {
        if (isTyping) return;
        sendUserMessage(item.nav_btn);
        const segments = item.response.split('[BREAK]').map(s => s.trim());
        for (let i = 0; i < segments.length; i++) {
            await typeEffect(segments[i], i === 0);
            await wait(600); 
        }
    }

    async function handleSearch() {
        const input = document.getElementById('user-input');
        const query = input.value.trim().toLowerCase();
        if (!query || isTyping) return;
        sendUserMessage(input.value);
        input.value = "";
        const match = KNOWLEDGE_DATA.find(item => item.keywords.some(k => query.includes(k)));
        if (match) {
            const segments = match.response.split('[BREAK]').map(s => s.trim());
            for (let i = 0; i < segments.length; i++) {
                await typeEffect(segments[i], i === 0);
                await wait(600);
            }
        } else {
            await typeEffect("è¯¥ç»´åº¦å°šæœªå¯¹é½ã€‚å»ºè®®è¾“å…¥å…³é”®è¯ï¼Œæˆ–å’¨è¯¢ï¼š<b>qiuwu999</b>", true);
        }
    }

    function sendUserMessage(text) {
        const chat = document.getElementById('chat-container');
        const row = document.createElement('div');
        row.className = 'msg-row user';
        row.innerHTML = `<div class="bubble">${text}</div>`;
        chat.appendChild(row);
        chat.scrollTop = chat.scrollHeight;
    }

    function typeEffect(text, showAvatar = true) {
        return new Promise(resolve => {
            isTyping = true;
            const chat = document.getElementById('chat-container');
            const row = document.createElement('div');
            row.className = `msg-row bot`;
            row.innerHTML = `
                ${showAvatar ? '<img src="profile.jpg" class="avatar-chat" onerror="this.src=\'https://via.placeholder.com/100?text=Q\'">' : '<div class="avatar-placeholder"></div>'}
                <div class="bubble"></div>
            `;
            chat.appendChild(row);
            const bubble = row.querySelector('.bubble');

            let i = 0;
            const interval = setInterval(() => {
                if (i < text.length) {
                    if (text[i] === '<') {
                        let end = text.indexOf('>', i);
                        bubble.innerHTML += text.substring(i, end + 1);
                        i = end + 1;
                    } else {
                        bubble.innerHTML += text[i];
                        i++;
                    }
                    chat.scrollTop = chat.scrollHeight;
                } else {
                    clearInterval(interval);
                    isTyping = false;
                    // å®‰å…¨æ¸²æŸ“å…¬å¼
                    if (window.MathJax && MathJax.typesetPromise) {
                        MathJax.typesetPromise([bubble]).catch(e => console.log(e));
                    }
                    resolve();
                }
            }, 15);
        });
    }

    // åˆå§‹åŒ–æ‰“æ‹›å‘¼
    async function welcome() {
        initNav();
        await wait(800);
        await typeEffect("ä½ å¥½ï¼æˆ‘æ˜¯ç§‹æ­¦è€å¸ˆçš„ AI åŠ©ç†ã€‚ğŸŒ¸", true);
        await wait(600);
        await typeEffect("è€ƒå­¦é€»è¾‘åº“å·²å…¨é‡åŠ è½½ã€‚è¯·ç‚¹å‡»å·¦ä¾§ç»´åº¦æˆ–è¾“å…¥å…³é”®è¯å’¨è¯¢ã€‚", false);
    }

    document.addEventListener('DOMContentLoaded', welcome);
</script>
</body>
</html>
